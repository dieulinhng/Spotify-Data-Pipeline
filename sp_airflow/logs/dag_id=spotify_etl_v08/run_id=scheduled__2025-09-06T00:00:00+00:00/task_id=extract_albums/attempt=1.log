{"timestamp":"2025-09-06T08:44:01.889627","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-09-06T08:44:01.894114","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/spotify_etl_v2.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-09-06T08:44:20.489135","level":"info","event":"Connection Retrieved 'gcp_spotify'","logger":"airflow.hooks.base"}
{"timestamp":"2025-09-06T08:44:20.528665","level":"info","event":"Connection Retrieved 'gcp_spotify'","logger":"airflow.hooks.base"}
{"timestamp":"2025-09-06T11:09:46.283155","level":"error","event":"HTTP Error for GET to https://api.spotify.com/v1/artists/5OWksQm7ONWIGZqMXovSli/albums with Params: {'include_groups': 'album,single,compilation,appears_on', 'country': None, 'limit': 25, 'offset': 0} returned 401 due to The access token expired","logger":"spotipy.client"}
{"timestamp":"2025-09-06T11:09:46.292920","level":"error","event":"Failed","logger":"root","error_detail":[{"exc_type":"SpotifyException","exc_value":"http status: 401, code: -1 - https://api.spotify.com/v1/artists/5OWksQm7ONWIGZqMXovSli/albums?include_groups=album%2Csingle%2Ccompilation%2Cappears_on&limit=25&offset=0:\n The access token expired, reason: None","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/opt/airflow/dags/spotify_etl_v2.py","lineno":150,"name":"extract_albums"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/spotipy/client.py","lineno":430,"name":"artist_albums"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/spotipy/client.py","lineno":324,"name":"_get"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/spotipy/client.py","lineno":294,"name":"_internal_call"}],"is_group":false,"exceptions":[]},{"exc_type":"HTTPError","exc_value":"401 Client Error: Unauthorized for url: https://api.spotify.com/v1/artists/5OWksQm7ONWIGZqMXovSli/albums?include_groups=album%2Csingle%2Ccompilation%2Cappears_on&limit=25&offset=0","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/spotipy/client.py","lineno":274,"name":"_internal_call"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/requests/models.py","lineno":1026,"name":"raise_for_status"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-09-06T11:10:01.982393","level":"info","event":"Data stream uploaded to 20250906/album.json in spotify_raw_bucket_v2 bucket","logger":"airflow.task.hooks.airflow.providers.google.cloud.hooks.gcs.GCSHook"}
{"timestamp":"2025-09-06T11:10:03.123260","level":"info","event":"Data stream uploaded to 20250906/album_artists.json in spotify_raw_bucket_v2 bucket","logger":"airflow.task.hooks.airflow.providers.google.cloud.hooks.gcs.GCSHook"}
{"timestamp":"2025-09-06T11:10:03.190339","level":"info","event":"Done. Returned value was: None","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
