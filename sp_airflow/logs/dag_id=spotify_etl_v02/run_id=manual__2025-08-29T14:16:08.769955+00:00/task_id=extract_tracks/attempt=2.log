{"timestamp":"2025-08-29T17:57:02.186048","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-08-29T17:57:02.188044","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/spotify_etl.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-08-29T17:57:03.571493","level":"info","event":"Connection Retrieved 'gcp_spotify'","logger":"airflow.hooks.base"}
{"timestamp":"2025-08-29T18:57:53.169546","level":"warning","event":"Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError(\"HTTPSConnectionPool(host='api.spotify.com', port=443): Read timed out. (read timeout=30)\")': /v1/albums/7gX0577znR5JShZZwQFkq9/tracks/?limit=50&offset=0","logger":"urllib3.connectionpool"}
{"timestamp":"2025-08-29T18:57:53.409413","level":"error","event":"HTTP Error for GET to https://api.spotify.com/v1/albums/7gX0577znR5JShZZwQFkq9/tracks/ with Params: {'limit': 50, 'offset': 0, 'market': None} returned 401 due to The access token expired","logger":"spotipy.client"}
{"timestamp":"2025-08-29T18:57:53.412286","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"TypeError","exc_value":"exception() missing 1 required positional argument: 'msg'","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":877,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1164,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":397,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":217,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":240,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/spotify_etl.py","lineno":205,"name":"extract_tracks"}],"is_group":false,"exceptions":[]},{"exc_type":"SpotifyException","exc_value":"http status: 401, code: -1 - https://api.spotify.com/v1/albums/7gX0577znR5JShZZwQFkq9/tracks/?limit=50&offset=0:\n The access token expired, reason: None","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/opt/airflow/dags/spotify_etl.py","lineno":203,"name":"extract_tracks"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/spotipy/client.py","lineno":492,"name":"album_tracks"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/spotipy/client.py","lineno":324,"name":"_get"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/spotipy/client.py","lineno":294,"name":"_internal_call"}],"is_group":false,"exceptions":[]},{"exc_type":"HTTPError","exc_value":"401 Client Error: Unauthorized for url: https://api.spotify.com/v1/albums/7gX0577znR5JShZZwQFkq9/tracks/?limit=50&offset=0","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/spotipy/client.py","lineno":274,"name":"_internal_call"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/requests/models.py","lineno":1026,"name":"raise_for_status"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-08-29T18:57:54.359628","level":"error","event":"Top level error","logger":"task","error_detail":[{"exc_type":"AirflowRuntimeError","exc_value":"API_SERVER_ERROR: {'status_code': 403, 'message': 'Invalid auth token: Signature has expired', 'detail': {'detail': 'Invalid auth token: Signature has expired'}}","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1300,"name":"main"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":954,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/comms.py","lineno":203,"name":"send"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/comms.py","lineno":263,"name":"_get_response"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/comms.py","lineno":250,"name":"_from_frame"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-08-29T18:57:59.426876Z","level":"warning","event":"Process exited abnormally","exit_code":1,"logger":"task"}
